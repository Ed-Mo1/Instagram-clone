import{f as C,u as fe,o as M,g as pe,r as w,b as je,j as e,c as y,a as $,d as be,m as we,e as se,h as te,i as k,k as j,l as O,n as D,s as E,p as W,q as v,t as U,v as V,w as q,x as X,y as ye,z as K,A as ae,B as G,C as Se,D as ve,M as ne,E as oe,F as re,G as Ce,H as ie,I as le,J as c,S as F,K as P,L as A,N as S,O as z,P as _,Q as Pe,R as ce,T as ze,V as N,U as h,W as I,X as Ie,Y as ke,Z as Ae,_ as Ne,$ as L,a0 as Re,a1 as Fe,a2 as Q,a3 as _e,a4 as De,a5 as Ee,a6 as We,a7 as Z,a8 as Ge,a9 as Le,aa as He}from"./index-BAF7UZVp.js";import{t as Be,C as Te,P as Me,S as H,a as $e}from"./PostFooter-B03SR5wN.js";function Oe(a){const s=Object.assign({},a);for(let n in s)s[n]===void 0&&delete s[n];return s}var de=C(function(s,n){const o=fe("Avatar",s),{children:t,borderColor:i,max:r,spacing:l="-0.75rem",borderRadius:m="full",...x}=M(s),g=pe(t),d=r!=null?g.slice(0,r):g,f=r!=null?g.length-r:0,b=d.reverse().map((Y,ue)=>{var J;const ge={marginEnd:ue===0?0:l,size:s.size,borderColor:(J=Y.props.borderColor)!=null?J:i,showBorder:!0};return w.cloneElement(Y,Oe(ge))}),p={display:"flex",alignItems:"center",justifyContent:"flex-end",flexDirection:"row-reverse",...o.group},R={borderRadius:m,marginStart:l,...je,...o.excessLabel};return e.jsxs(y.div,{ref:n,role:"group",__css:p,...x,className:$("chakra-avatar__group",s.className),children:[f>0&&e.jsx(y.span,{className:"chakra-avatar__excess",__css:R,children:`+${f}`}),b]})});de.displayName="AvatarGroup";var me=C(function(s,n){const{templateAreas:o,gap:t,rowGap:i,columnGap:r,column:l,row:m,autoFlow:x,autoRows:g,templateRows:d,autoColumns:f,templateColumns:u,...b}=s,p={display:"grid",gridTemplateAreas:o,gridGap:t,gridRowGap:i,gridColumnGap:r,gridAutoColumns:f,gridColumn:l,gridRow:m,gridAutoFlow:x,gridAutoRows:g,gridTemplateRows:d,gridTemplateColumns:u};return e.jsx(y.div,{ref:n,__css:p,...b})});me.displayName="Grid";function ee(a){return we(a,s=>s==="auto"?"auto":`span ${s}/span ${s}`)}var he=C(function(s,n){const{area:o,colSpan:t,colStart:i,colEnd:r,rowEnd:l,rowSpan:m,rowStart:x,...g}=s,d=be({gridArea:o,gridColumn:ee(t),gridRow:ee(m),gridColumnStart:i,gridColumnEnd:r,gridRowStart:x,gridRowEnd:l});return e.jsx(y.div,{ref:n,__css:d,...g})});he.displayName="GridItem";var xe=C(function(s,n){const o=se("Heading",s),{className:t,...i}=M(s);return e.jsx(y.h2,{ref:n,className:$("chakra-heading",s.className),...i,__css:o})});xe.displayName="Heading";var B=y("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});B.displayName="Center";var Ue={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};C(function(s,n){const{axis:o="both",...t}=s;return e.jsx(y.div,{ref:n,__css:Ue[o],...t,position:"absolute"})});var T=C(function(s,n){const{borderLeftWidth:o,borderBottomWidth:t,borderTopWidth:i,borderRightWidth:r,borderWidth:l,borderStyle:m,borderColor:x,...g}=se("Divider",s),{className:d,orientation:f="horizontal",__css:u,...b}=M(s),p={vertical:{borderLeftWidth:o||r||l||"1px",height:"100%"},horizontal:{borderBottomWidth:t||i||l||"1px",width:"100%"}};return e.jsx(y.hr,{ref:n,"aria-orientation":f,...b,__css:{...g,border:"0",borderColor:x,borderStyle:m,...p[f],...u},className:$("chakra-divider",d)})});T.displayName="Divider";const Ve=()=>{const a=te(),s=k(),[n,o]=w.useState(!1),{user:t}=j(l=>l.user),i=O();return{editProfile:async(l,m)=>{if(n||!t)return;o(!0);const x=D(E,`profilePics/${t==null?void 0:t.id}`),g=W(v,"users",t==null?void 0:t.id),d=U(v,"users"),f=V(d,q("username","==",l.username)),u=await X(f);if(!u.empty&&u.docs[0].id!==(t==null?void 0:t.id)){i({title:"Error",message:"Username already exists",status:"error"}),o(!1);return}let b="";try{m&&(await ye(x,m,"data_url"),b=await K(x),b=await K(D(E,`profilePics/${t==null?void 0:t.id}`)));const p={...t,fullName:l.fullName||(t==null?void 0:t.fullName),username:l.username||(t==null?void 0:t.username),bio:l.bio||(t==null?void 0:t.bio),profilePictureUrl:b||(t==null?void 0:t.profilePictureUrl)};await ae(g,p),localStorage.setItem("user",JSON.stringify(p));const R=a.pathname.replace(`/${t==null?void 0:t.username}`,`/${p.username}`);window.history.replaceState({},"",R),s(G(p)),s(Se(p)),i({title:"Success",message:"Profile updated successfully",status:"success"})}catch(p){i({title:"Error",message:p.message,status:"error"})}finally{o(!1)}},isUpdating:n}},qe=({isOpen:a,onClose:s})=>{const[n,o]=w.useState({fullName:"",username:"",bio:""}),{user:t}=j(u=>u.user),i=w.useRef(null),{handleImageChange:r,selectedFile:l,setSelectedFile:m}=ve(),{isUpdating:x,editProfile:g}=Ve(),d=O(),f=async()=>{try{await g(n,l),m(null),s()}catch(u){d({title:"Error",message:u.message,status:"error"})}};return e.jsx(e.Fragment,{children:e.jsxs(ne,{isOpen:a,onClose:s,children:[e.jsx(oe,{}),e.jsxs(re,{bg:"black",boxShadow:"xl",border:"1px solid gray",mx:3,children:[e.jsx(Ce,{}),e.jsx(ie,{}),e.jsx(le,{children:e.jsx(c,{bg:"black",children:e.jsxs(F,{spacing:4,w:"full",maxW:"md",bg:"black",p:6,my:0,children:[e.jsx(xe,{lineHeight:1.1,fontSize:{base:"2xl",sm:"3xl"},children:"Edit Profile"}),e.jsx(P,{children:e.jsxs(F,{direction:["column","row"],spacing:6,children:[e.jsx(B,{children:e.jsx(A,{size:"xl",src:l||(t==null?void 0:t.profilePictureUrl),border:"2px solid white "})}),e.jsx(B,{w:"full",children:e.jsx(S,{w:"full",onClick:()=>i.current.click(),children:"Edit Profile Picture"})}),e.jsx(z,{type:"file",hidden:!0,ref:i,onChange:r})]})}),e.jsxs(P,{children:[e.jsx(_,{fontSize:"sm",children:"Full Name"}),e.jsx(z,{placeholder:"Full Name",size:"sm",type:"text",value:n.fullName||(t==null?void 0:t.fullName),onChange:u=>o({...n,fullName:u.target.value})})]}),e.jsxs(P,{children:[e.jsx(_,{fontSize:"sm",children:"Username"}),e.jsx(z,{placeholder:"Username",size:"sm",type:"text",value:n.username||(t==null?void 0:t.username),onChange:u=>o({...n,username:u.target.value})})]}),e.jsxs(P,{children:[e.jsx(_,{fontSize:"sm",children:"Bio"}),e.jsx(z,{placeholder:"Bio",size:"sm",type:"text",value:n.bio||(t==null?void 0:t.bio),onChange:u=>o({...n,bio:u.target.value})})]}),e.jsxs(F,{spacing:6,direction:["column","row"],children:[e.jsx(S,{bg:"red.400",color:"white",w:"full",size:"sm",_hover:{bg:"red.500"},onClick:s,children:"Cancel"}),e.jsx(S,{bg:"blue.400",color:"white",size:"sm",w:"full",_hover:{bg:"blue.500"},onClick:f,isLoading:x,children:"Submit"})]})]})})})]})]})})},Xe=({currentUser:a})=>{const s=Pe(),n=te(),{isOpen:o,onOpen:t,onClose:i}=ce(),{followUser:r,isFollowing:l,loading:m}=ze(a),{user:x}=j(d=>d.user),g=(x==null?void 0:x.username)===a.username;return e.jsxs(c,{gap:{base:4,sm:10},py:10,direction:{base:"column",sm:"row"},children:[e.jsx(de,{size:{base:"xl",md:"2xl"},justifySelf:"center",alignSelf:"flex-start",mx:"auto",children:e.jsx(A,{src:a==null?void 0:a.profilePictureUrl})}),e.jsxs(N,{alignItems:"start",gap:2,mx:"auto",flex:1,children:[e.jsxs(c,{gap:4,direction:{base:"column",sm:"row"},justifyContent:{base:"center",sm:"flex-start"},alignItems:"center",w:"full",children:[e.jsx(h,{fontSize:{base:"sm",md:"lg"},children:a==null?void 0:a.username}),g&&e.jsx(c,{gap:4,alignItems:"center",justifyContent:"center",children:e.jsx(S,{bg:"white",color:"black",_hover:{bg:"whiteAlpha.800"},size:{base:"xs",md:"sm"},onClick:t,children:"Edit Profile"})}),!g&&e.jsx(c,{gap:4,alignItems:"center",justifyContent:"center",children:e.jsx(S,{bg:"blue.500",color:"white",_hover:{bg:"blue.600"},size:{base:"xs",md:"sm"},onClick:()=>{if(!x){s("/Instagram-clone/auth",{replace:!0,state:{from:n.pathname}});return}r(a)},isLoading:m,children:l?"Unfollow":"Follow"})})]}),e.jsxs(c,{alignItems:"center",gap:{base:2,sm:4},children:[e.jsxs(h,{fontSize:{base:"xs",md:"sm"},children:[e.jsx(h,{as:"span",fontWeight:"bold",mr:1,children:a.posts.length}),"Posts"]}),e.jsxs(h,{fontSize:{base:"xs",md:"sm"},children:[e.jsx(h,{as:"span",fontWeight:"bold",mr:1,children:a.followers.length}),"Followers"]}),e.jsxs(h,{fontSize:{base:"xs",md:"sm"},children:[e.jsx(h,{as:"span",fontWeight:"bold",mr:1,children:a.following.length}),"Following"]})]}),e.jsx(c,{alignItems:"center",gap:4,children:e.jsx(h,{fontSize:"sm",fontWeight:"bold",children:a.fullName})}),e.jsx(h,{fontSize:"sm",children:a.bio})]}),o&&e.jsx(qe,{isOpen:o,onClose:i})]})},Ye=()=>e.jsxs(c,{w:"full",justifyContent:"center",gap:{base:4,sm:10},textTransform:"uppercase",fontWeight:"bold",children:[e.jsxs(c,{borderTop:"1px solid white",alignItems:"center",p:"3",gap:1,cursor:"pointer",children:[e.jsx(I,{fontSize:20,children:e.jsx(Ie,{})}),e.jsx(h,{fontSize:12,display:{base:"none",sm:"block"},children:"Posts"})]}),e.jsxs(c,{alignItems:"center",p:"3",gap:1,cursor:"pointer",children:[e.jsx(I,{fontSize:20,children:e.jsx(ke,{})}),e.jsx(h,{fontSize:12,display:{base:"none",sm:"block"},children:"Saved"})]}),e.jsxs(c,{alignItems:"center",p:"3",gap:1,cursor:"pointer",children:[e.jsx(I,{fontSize:20,children:e.jsx(Ae,{fontWeight:"bold"})}),e.jsx(h,{fontSize:12,display:{base:"none",sm:"block"},children:"Likes"})]})]}),Je=a=>{const s=k(),{profile:n}=j(r=>r.profile),[o,t]=w.useState(!1),i=async()=>{t(!0);try{const r=U(v,"users"),l=V(r,q("username","==",a)),m=await X(l);m.empty?s(G(null)):s(G(m.docs[0].data()))}catch(r){console.log(r)}finally{t(!1)}};return w.useEffect(()=>{i()},[a]),{profile:n,loading:o}};function Ke(a){return Ne({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(a)}const Qe=({post:a})=>{const{profile:s}=j(n=>n.profile);return e.jsxs(c,{gap:4,children:[e.jsx(L,{to:`/Instagram-clone/${s==null?void 0:s.username}`,children:e.jsx(A,{src:s==null?void 0:s.profilePictureUrl,size:"sm"})}),e.jsxs(c,{direction:"column",children:[e.jsxs(c,{gap:2,alignItems:"center",children:[e.jsx(L,{to:`/Instagram-clone/${s==null?void 0:s.username}`,children:e.jsx(h,{fontWeight:"bold",fontSize:12,children:s==null?void 0:s.username})}),e.jsx(h,{fontSize:14,children:a.caption})]}),e.jsx(h,{fontSize:12,color:"gray",children:Be(a==null?void 0:a.createdAt)})]})]})},Ze=({post:a})=>{const s=k(),{isOpen:n,onOpen:o,onClose:t}=ce(),{profile:i}=j(d=>d.profile),{user:r}=j(d=>d.user),l=O(),[m,x]=w.useState(!1),g=async()=>{if(window.confirm("Are you sure you want to delete this post?")&&!m)try{const d=D(E,`posts/${a.id}`);await _e(d);const f=W(v,"users",r.id);await De(W(v,"posts",a.id)),await ae(f,{posts:r==null?void 0:r.posts.filter(({id:u})=>u!==a.id)}),s(Ee(a.id)),s(We(a.id)),t(),l({title:"Success",message:"Post deleted successfully",status:"success"})}catch(d){l({title:"Error",message:d.message,status:"error"})}finally{x(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(he,{cursor:"pointer",borderRadius:4,overflow:"hidden",border:"1px solid",borderColor:"whiteAlpha.300",position:"relative",aspectRatio:1/1,onClick:o,children:[e.jsx(c,{opacity:0,_hover:{opacity:1},position:"absolute",top:0,left:0,right:0,bottom:0,bg:"blackAlpha.700",transition:"all 0.3s ease",zIndex:1,justifyContent:"center",children:e.jsxs(c,{alignItems:"center",justifyContent:"center",gap:50,children:[e.jsxs(c,{children:[e.jsx(Re,{size:20}),e.jsx(h,{fontWeight:"bold",ml:2,children:a.likes.length})]}),e.jsxs(c,{children:[e.jsx(Fe,{size:20}),e.jsx(h,{fontWeight:"bold",ml:2,children:a.comments.length})]})]})}),e.jsx(Q,{src:a.imageURL,alt:"profile post",w:"100%",h:"100%",objectFit:"cover"})]}),e.jsxs(ne,{isOpen:n,onClose:t,isCentered:!0,size:{base:"3xl",md:"5xl"},children:[e.jsx(oe,{}),e.jsxs(re,{children:[e.jsx(ie,{}),e.jsx(le,{bg:"black",pb:5,children:e.jsxs(c,{gap:"4",w:{base:"90%",sm:"70%",md:"full"},mx:"auto",maxH:"90vh",minH:"50vh",children:[e.jsx(c,{borderRadius:4,overflow:"hidden",border:"1px solid",borderColor:"whiteAlpha.300",flex:1.5,justifyContent:"center",alignItems:"center",children:e.jsx(Q,{src:a.imageURL,alt:"profile post"})}),e.jsxs(c,{flex:1,flexDir:"column",px:10,display:{base:"none",md:"flex"},children:[e.jsxs(c,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(c,{alignItems:"center",gap:4,children:[e.jsx(A,{src:i==null?void 0:i.profilePictureUrl,size:"sm",name:"As a Programmer"}),e.jsx(h,{fontWeight:"bold",fontSize:12,children:i==null?void 0:i.username})]}),(r==null?void 0:r.id)===(i==null?void 0:i.id)&&e.jsx(S,{size:"sm",bg:"transparent",_hover:{bg:"whiteAlpha.300",color:"red.600"},borderRadius:4,p:1,onClick:g,isLoading:m,children:e.jsx(Ke,{size:20,cursor:"pointer"})})]}),e.jsx(T,{my:4,bg:"gray.500"}),e.jsxs(N,{w:"full",alignItems:"start",maxH:"350px",overflowY:"auto",children:[a.caption&&e.jsx(Qe,{post:a}),a.comments.map(d=>e.jsx(Te,{comment:d},d.id))]}),e.jsx(T,{my:4,bg:"gray.8000"}),e.jsx(Me,{post:a,creatorProfile:i,isProfilePage:!0})]})]})})]})]})]})},es=()=>{const a=k(),{profile:s}=j(r=>r.profile),[n,o]=w.useState(!1),{posts:t}=j(r=>r.posts),i=async()=>{const r=V(U(v,"posts"),q("createdBy","==",s==null?void 0:s.id));o(!0);try{const l=await X(r);l.empty?a(Z([])):a(Z(l.docs.map(m=>({...m.data(),id:m.id}))))}catch(l){console.log(l)}finally{o(!1)}};return w.useEffect(()=>{i()},[s==null?void 0:s.posts]),{loading:n,posts:t}},ss=()=>{const{loading:a,posts:s}=es();return!a&&s.length===0?e.jsx(ts,{}):e.jsxs(me,{templateColumns:{sm:"repeat(1, 1fr)",md:"repeat(3, 1fr)"},gap:1,columnGap:1,children:[a&&[0,1,2].map((o,t)=>e.jsx(N,{alignItems:"flex-start",gap:4,children:e.jsx(H,{w:"full",children:e.jsx(I,{h:"300px",children:"contents wrapped"})})},t)),!a&&e.jsx(e.Fragment,{children:s.map(o=>e.jsx(Ze,{post:o},o.id))})]})},ts=()=>e.jsx(c,{flexDir:"column",textAlign:"center",mx:"auto",mt:10,children:e.jsx(h,{fontSize:"2xl",children:"No Posts Found🤔"})}),ls=()=>{const{username:a}=Ge(),{loading:s}=Je(a),{profile:n}=j(o=>o.profile);return!s&&!n?e.jsx(as,{}):e.jsxs(Le,{maxW:"container.lg",py:5,children:[e.jsxs(c,{py:10,px:4,w:"full",mx:"auto",flexDirection:"column",pl:{base:4,md:10},children:[!s&&n&&e.jsx(Xe,{currentUser:n}),s&&e.jsx(ns,{})]}),e.jsxs(c,{px:4,borderTop:"1px solid",borderColor:"whiteAlpha.300",py:10,w:"full",mx:"auto",flexDirection:"column",children:[e.jsx(Ye,{}),e.jsx(ss,{})]})]})},as=()=>e.jsxs(c,{flexDir:"column",textAlign:"center",mx:"auto",children:[e.jsx(h,{fontSize:"2xl",children:"User Not Found"}),e.jsx(He,{as:L,to:"/",color:"blue.500",w:"max-content",mx:"auto",children:"Go home"})]}),ns=()=>e.jsxs(c,{gap:{base:4,sm:10},py:10,direction:{base:"column",sm:"row"},justifyContent:"center",alignItems:"center",children:[e.jsx($e,{size:"24"}),e.jsxs(N,{alignItems:{base:"center",sm:"flex-start"},gap:2,mx:"auto",flex:1,children:[e.jsx(H,{height:"12px",width:"150px"}),e.jsx(H,{height:"12px",width:"100px"})]})]});export{ls as default};
