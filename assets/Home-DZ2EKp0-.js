import{T as W,j as e,J as c,$ as p,L as I,U as y,N as b,W as m,a2 as v,l as B,i as R,k as j,r as l,v as U,t as k,q as L,w as C,x as F,a7 as w,a9 as z,V as u,ab as $,aa as S,ac as E,ad as D,ae as T}from"./index-BAF7UZVp.js";import{t as _,u as q,P as H,a as G,S as f}from"./PostFooter-B03SR5wN.js";const N=({userProfile:s,createdAt:n})=>{const{isFollowing:t,loading:a,followUser:r}=W(s);return e.jsxs(c,{alignItems:"center",my:2,justifyContent:"space-between",children:[e.jsxs(c,{gap:2,alignItems:"center",children:[e.jsx(p,{to:`/Instagram-clone/${s==null?void 0:s.username}`,children:e.jsx(I,{src:s==null?void 0:s.profilePictureUrl,size:"sm"})}),e.jsxs(c,{fontSize:12,alignItems:"center",fontWeight:"bold",gap:{base:1,md:2},children:[e.jsx(p,{to:`/Instagram-clone/${s==null?void 0:s.username}`,children:e.jsx(y,{children:s==null?void 0:s.username})}),e.jsx(y,{fontSize:{base:"11px",md:"12px"},color:"gray.500",children:_(n)})]})]}),e.jsx(b,{fontSize:12,fontWeight:"bold",background:"transparent",_hover:{color:"white"},color:"blue.500",isLoading:a,onClick:()=>r(s),children:t?"Following":"Follow"})]})},V=({post:s})=>{const{userProfile:n}=q(s.createdBy);if(n)return e.jsxs(e.Fragment,{children:[e.jsx(N,{userProfile:n,createdAt:s.createdAt}),e.jsx(m,{my:2,children:e.jsx(v,{borderRadius:10,src:s.imageURL,alt:"photo",w:"100%"})}),e.jsx(H,{isProfilePage:!1,post:s,creatorProfile:n})]})},J=()=>{const s=B(),n=R(),{posts:t}=j(o=>o.posts),{user:a}=j(o=>o.user),[r,d]=l.useState(!1),i=async()=>{d(!0);try{const o=U(k(L,"posts"),C("createdBy","!=",a==null?void 0:a.id)),g=await F(o);if(g.empty)n(w([]));else{const x=g.docs.map(h=>({...h.data(),id:h.id})).sort((h,A)=>A.createdAt-h.createdAt);n(w(x))}}catch(o){s({title:"Error",message:o.message,status:"error"})}finally{d(!1)}};return l.useEffect(()=>{i()},[]),{loading:r,posts:t}},K=()=>{const{loading:s,posts:n}=J();return e.jsx(z,{children:s?Array.from({length:5}).map((t,a)=>e.jsxs(u,{gap:2,mb:10,alignItems:"flex-start",children:[e.jsxs(c,{gap:2,alignItems:"center",children:[e.jsx(G,{size:"10"}),e.jsxs(u,{alignItems:"flex-start",gap:2,children:[e.jsx(f,{height:"10px",width:"200px"}),e.jsx(f,{height:"10px",width:"200px"})]})]}),e.jsx(f,{height:"500px",width:"100%"})]},a)):n.length?n.map(t=>e.jsx(V,{post:t},t.id)):e.jsx(m,{h:"100vh",display:"flex",justifyContent:"center",alignItems:"center",children:"No posts"})})},M=()=>{const{signoutUser:s,loading:n}=$(),{user:t}=j(a=>a.user);return e.jsxs(c,{w:"full",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{gap:2,alignItems:"center",children:[e.jsx(S,{as:p,to:`/Instagram-clone/${t==null?void 0:t.username}`,children:e.jsx(I,{src:t==null?void 0:t.profilePictureUrl,size:"sm"})}),e.jsx(S,{as:p,to:`/Instagram-clone/${t==null?void 0:t.username}`,fontSize:12,fontWeight:"bold",children:t==null?void 0:t.username})]}),e.jsx(b,{fontSize:14,color:"blue.500",fontWeight:"medium",bg:"transparent",_hover:{bg:"transparent",color:"white"},onClick:s,isLoading:n,children:"Log out"})]})},O=()=>{const{user:s}=j(i=>i.user),[n,t]=l.useState(!0),[a,r]=l.useState([]),d=l.useCallback(async()=>{t(!0);try{const i=k(L,"users"),o=U(i,C("id","not-in",[s.id,...s.following.map(x=>x.id)]),E("id"),D(5)),g=await F(o);g.empty?r([]):r(g.docs.map(x=>x.data()))}catch(i){console.log(i)}finally{t(!1)}},[s]);return l.useEffect(()=>{s&&d()},[s,r,d]),{loading:n,suggestedUsers:a}},Q=()=>{const{loading:s,suggestedUsers:n}=O();return e.jsxs(u,{gap:4,py:8,px:6,children:[e.jsx(M,{}),e.jsxs(c,{w:"full",justifyContent:"space-between",alignItems:"center",children:[e.jsx(y,{fontSize:12,fontWeight:"bold",color:"gray.500",children:"Suggested for you"}),e.jsx(b,{p:0,bg:"transparent",_hover:{bg:"transparent",color:"gray.400"},color:"blue.500",children:"See all"})]}),e.jsx(u,{gap:4,w:"full",children:s?"Loading...":n==null?void 0:n.map(t=>e.jsx(T,{user:t},t.username))})]})},Z=()=>e.jsx(z,{maxW:"container.lg",children:e.jsxs(c,{gap:{md:5,lg:10},justifyContent:"center",children:[e.jsx(m,{flex:{md:3,lg:2},py:10,children:e.jsx(K,{})}),e.jsx(m,{flex:3,position:"sticky",top:0,mr:{lg:20},maxW:"300px",h:"fit-content",display:{base:"none",md:"block"},children:e.jsx(Q,{})})]})});export{Z as default};
